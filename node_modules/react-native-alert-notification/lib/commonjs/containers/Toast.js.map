{"version":3,"sources":["Toast.tsx"],"names":["Toast","React","Component","constructor","props","context","prevProps","isDark","setState","prevState","styles","__styles","args","state","visible","_timeout","clearTimeout","_startAnimation","ACTION","CLOSE","_positionToast","Animated","Value","Promise","resolve","config","OPEN","autoClose","undefined","duration","ENV","AUTO_CLOSE","setTimeout","_close","onShow","onHide","action","timing","toValue","top","_cardHeight","useNativeDriver","start","type","title","textBody","onPress","onLongPress","nativeEvent","layout","height","StyleSheet","flatten","cardRow","transform","translateY","cardContainer","backendImage","image","overflow","flex","titleLabel","descLabel","_CardRender","cardHeight","SafeAreaInsetsContext","createRef","instance","current","_open","create","backgroundContainer","absoluteFillObject","backgroundColor","container","position","left","right","zIndex","flexDirection","borderRadius","paddingHorizontal","paddingTop","paddingBottom","marginHorizontal","marginBottom","Color","get","fontWeight","fontSize","color","alignSelf","width","aspectRatio","marginRight","ALERT_TYPE","SUCCESS","tintColor","DANGER","WARNING"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Animated, Image, Pressable, StyleSheet, Text, View } from 'react-native';\nimport { SafeAreaInsetsContext } from 'react-native-safe-area-context';\nimport ENV, { ACTION, ALERT_TYPE } from '../config/ENV';\nimport { getImage } from '../service';\nimport Color from '../service/color';\n\nexport type IConfig = {\n  type?: ALERT_TYPE;\n  // position?: TOAST_POSITION;\n  title?: string;\n  textBody?: string;\n  autoClose?: number | boolean;\n  onPress?: () => void;\n  onLongPress?: () => void;\n  onShow?: () => void;\n  onHide?: () => void;\n};\n\ntype IProps = {\n  isDark: boolean;\n  config?: Pick<IConfig, 'autoClose'>;\n};\n\ntype IState = {\n  styles: ReturnType<typeof __styles>;\n  cardHeight: number;\n  overlayClose?: boolean;\n  visible: boolean;\n  config?: IConfig;\n};\nclass Toast extends React.Component<IProps, IState> {\n  /**\n   * @type {React.Context<EdgeInsets | null>}\n   */\n  static contextType = SafeAreaInsetsContext;\n\n  /**\n   * @type {React.RefObject<Toast>}\n   */\n  public static instance: React.RefObject<Toast> = React.createRef();\n\n  /**\n   * @param {IConfig} args\n   */\n  public static show = (args: IConfig): void => {\n    Toast.instance.current?._open(args);\n  };\n\n  /**\n   *\n   */\n  public static hide = (): void => {\n    Toast.instance.current?._close();\n  };\n\n  /**\n   * @type {React.ContextType<typeof SafeAreaInsetsContext>}\n   */\n  public context!: React.ContextType<typeof SafeAreaInsetsContext>;\n\n  /**\n   * @type {Animated.Value}\n   * @private\n   */\n  private _positionToast: Animated.Value;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  private _cardHeight: number;\n\n  /**\n   * @type {NodeJS.Timeout}\n   * @private\n   */\n  private _timeout?: NodeJS.Timeout;\n\n  /**\n   * @param {IProps} props\n   * @param {React.ContextType<typeof SafeAreaInsetsContext>} context\n   */\n  constructor(props: IProps, context: React.ContextType<typeof SafeAreaInsetsContext>) {\n    super(props, context);\n    this._cardHeight = 0;\n    this._positionToast = new Animated.Value(-500);\n    this.state = {\n      styles: __styles(props.isDark),\n      visible: false,\n      cardHeight: 0,\n    };\n  }\n\n  /**\n   * @param {Readonly<IProps>} prevProps\n   */\n  public componentDidUpdate = (prevProps: Readonly<IProps>): void => {\n    if (prevProps.isDark !== this.props.isDark) {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState((prevState) => ({\n        ...prevState,\n        styles: __styles(this.props.isDark),\n      }));\n    }\n  };\n\n  /**\n   * @param {IConfig} args\n   * @return {Promise<void>}\n   */\n  private _open = async (args: IConfig): Promise<void> => {\n    if (this.state.visible) {\n      if (this._timeout) {\n        clearTimeout(this._timeout);\n      }\n      await this._startAnimation(ACTION.CLOSE);\n    }\n    this._positionToast = new Animated.Value(-500);\n    await new Promise<void>((resolve) => this.setState((prevState) => ({ ...prevState, visible: true, config: args }), resolve));\n    await this._startAnimation(ACTION.OPEN);\n\n    const autoClose = this.state.config?.autoClose !== undefined ? this.state.config?.autoClose : this.props.config?.autoClose;\n    if (autoClose || autoClose === undefined) {\n      const duration = typeof autoClose === 'number' ? autoClose : ENV.AUTO_CLOSE;\n      this._timeout = setTimeout(() => this._close(), duration);\n    }\n    this.state.config?.onShow?.();\n  };\n\n  /**\n   * @return {Promise<void>}\n   */\n  private _close = async (): Promise<void> => {\n    await this._startAnimation(ACTION.CLOSE);\n    const onHide = this.state.config?.onShow;\n    await new Promise<void>((resolve) => this.setState((prevState) => ({ ...prevState, visible: false, config: undefined }), resolve));\n    onHide?.();\n  };\n\n  /**\n   * @param {ACTION} action\n   * @return {Promise<void>}\n   */\n  private _startAnimation = (action: ACTION): Promise<void> => {\n    return new Promise((resolve) => {\n      Animated.timing(this._positionToast, {\n        toValue: action === ACTION.OPEN ? this.context?.top ?? 0 : -this._cardHeight,\n        duration: 250,\n        useNativeDriver: true,\n      }).start(() => resolve());\n    });\n  };\n\n  /**\n   * @return {JSX.Element}\n   */\n  private _CardRender = (): JSX.Element => {\n    const { styles } = this.state;\n    if (this.state.config) {\n      const { type, title, textBody, onPress, onLongPress } = this.state.config;\n      return (\n        <Animated.View\n          onLayout={({\n            nativeEvent: {\n              layout: { height },\n            },\n          }) => (this._cardHeight = height)}\n          style={StyleSheet.flatten([styles.cardRow, { transform: [{ translateY: this._positionToast }] }])}\n        >\n          <Pressable style={styles.cardContainer} onPress={onPress} onLongPress={onLongPress}>\n            {type && (\n              <>\n                <View style={styles.backendImage} />\n                <Image source={getImage(type)} resizeMode=\"contain\" style={StyleSheet.flatten([styles.image, styles[`${type}Image`]])} />\n              </>\n            )}\n            {/* eslint-disable-next-line react-native/no-inline-styles */}\n            <View style={{ overflow: 'hidden', flex: 1 }}>\n              {title && <Text style={styles.titleLabel}>{title}</Text>}\n              {textBody && <Text style={styles.descLabel}>{textBody}</Text>}\n            </View>\n          </Pressable>\n        </Animated.View>\n      );\n    }\n    return <></>;\n  };\n\n  /**\n   * @return {JSX.Element}\n   */\n  public render = (): JSX.Element => {\n    const { visible } = this.state;\n    const { _CardRender } = this;\n    if (!visible) {\n      return <></>;\n    }\n    return <_CardRender />;\n  };\n}\n\nconst __styles = (isDark: boolean) =>\n  StyleSheet.create({\n    backgroundContainer: {\n      ...StyleSheet.absoluteFillObject,\n      backgroundColor: '#00000070',\n    },\n\n    container: {\n      position: 'absolute',\n      backgroundColor: '#00000030',\n      top: 0,\n      left: 0,\n      right: 0,\n    },\n\n    cardRow: {\n      zIndex: 9999,\n      position: 'absolute',\n      left: 0,\n      right: 0,\n    },\n\n    cardContainer: {\n      flexDirection: 'row',\n      borderRadius: 12,\n      paddingHorizontal: 12,\n      paddingTop: 12,\n      paddingBottom: 12,\n      marginHorizontal: 12,\n      marginBottom: 12,\n      backgroundColor: Color.get('card', isDark),\n    },\n\n    titleLabel: {\n      fontWeight: 'bold',\n      fontSize: 18,\n      color: Color.get('label', isDark),\n    },\n    descLabel: {\n      color: Color.get('label', isDark),\n    },\n    backendImage: {\n      position: 'absolute',\n      alignSelf: 'center',\n      height: 12,\n      width: 12,\n      backgroundColor: '#FBFBFB',\n      borderRadius: 100,\n      left: 12 + 7,\n    },\n    image: {\n      alignSelf: 'center',\n      width: 25,\n      aspectRatio: 1,\n      marginRight: 12,\n    },\n\n    [`${ALERT_TYPE.SUCCESS}Image`]: {\n      tintColor: Color.get('success', isDark),\n    },\n    [`${ALERT_TYPE.DANGER}Image`]: {\n      tintColor: Color.get('danger', isDark),\n    },\n    [`${ALERT_TYPE.WARNING}Image`]: {\n      tintColor: Color.get('warning', isDark),\n    },\n  });\n\nexport default Toast;\n"]}